sequence
CREATE SEQUENCE purchase_seq START 1;


CREATE TABLE purchase (
    purchase_id VARCHAR(10) PRIMARY KEY,  
    purchase_date date not null,
	arrival_date date not null,
	supplier_id varchar(20),
	foreign key (supplier_id) references supplier (supplier_id)
    
);


CREATE OR REPLACE FUNCTION generate_purchase_id()
RETURNS TRIGGER AS $$
BEGIN
   
    NEW.purchase_id := 'PC' || LPAD(nextval('purchase_seq')::TEXT, 4, '0');
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;


CREATE TRIGGER trg_purchase_id
BEFORE INSERT ON purchase
FOR EACH ROW
EXECUTE FUNCTION generate_purchase_id();
